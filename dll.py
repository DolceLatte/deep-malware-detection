import os
import random
from io import BytesIO
from zipfile import ZipFile

import requests


def save(index, save_dir):
    href = f"https://wikidll.com/download/{index}"
    source = requests.get(href, allow_redirects=True)
    with ZipFile(BytesIO(source.content)) as f:
        f.extractall(path=save_dir)


def main(num_files=5000, save_dir="raw/dll"):
    try:
        assert os.path.isdir(save_dir)
    except AssertionError:
        os.mkdir(save_dir)
    # https://wikidll.com/download/27785
    indices = random.sample(range(1, 27786), num_files)
    _ = [save(index, save_dir) for index in indices]


if __name__ == "__main__":
    main()
