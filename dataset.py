import os
import pickle

import pandas as pd
from torch.utils.data import Dataset


class MalWareDataset(Dataset):
    def __init__(self):
        self.labels = pd.read_csv("labels.csv")

    def __getitem__(self, index):
        file_name = self.labels.iloc[index, 0]
        label = torch.tensor(int(self.labels.iloc[index, 1]))
        with open("data") as f:
            file = torch.tensor(pickle.load(f))
        return file, label

    def __len__(self):
        return len(self.labels)
