# Neural Network Malware Binary Classification

PyTorch implementation of [1] [Malware Detection by Eating a Whole EXE](https://arxiv.org/abs/1710.09435), [2] [Learning the PE Header, Malware Detection with Minimal Domain Knowledge](https://arxiv.org/abs/1709.01471), and other derived custom models.

## Quickstart

Clone this repository via

```
git clone https://github.com/jaketae/pytorch-malware-detection.git
cd pytorch-malware-detection
```

Then, a Python virtual environment:

```
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

If you have [pipenv](https://pypi.org/project/pipenv/), you can also type

```
pipenv install -r requirements.txt
```

Train the model in Jupyter notebook titled `run.ipynb`, or start training in the terminal via

```
python train.py
```

Optional flags are documented below.

## Results

| Architecture   | # Parameters | Acc  | F1   | AUC  |
| -------------- | ------------ | ---- | ---- | ---- |
| MalConvBase    |              |      |      |      |
| MalConvPlus    |              |      |      |      |
| GRU-CNN        |              |      |      |      |
| LSTM-CNN       |              |      |      |      |
| ResGRU-CNN     |              |      |      |      |
| BiGRU-CNN      |              |      |      |      |
| AttnGRU-CNN    |              |      |      |      |
| AttnLSTM-CNN   |              |      |      |      |
| AttnResGRU-CNN |              |      |      |      |

## Contributing

The coding style is dictated by [black](https://black.readthedocs.io/en/stable/). Depending on development environment, you can toggle format-on-save options in your code editor or set up [pre-commit hooks](https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks) to make the linter run on every push.

Please feel free to submit issues or pull requests if you find bugs or ways to optimize the code base. Emails to jaesungtae@gmail.com is also welcome!

## References

[1] Malware Detection by Eating a Whole EXE

```
@misc{raff2017malware,
      title={Malware Detection by Eating a Whole EXE}, 
      author={Edward Raff and Jon Barker and Jared Sylvester and Robert Brandon and Bryan Catanzaro and Charles Nicholas},
      year={2017},
      eprint={1710.09435},
      archivePrefix={arXiv},
      primaryClass={stat.ML}
}
```

[2] Learning the PE Header, Malware Detection with Minimal Domain Knowledge

```
@article{Raff_2017,
   title={Learning the PE Header, Malware Detection with Minimal Domain Knowledge},
   ISBN={9781450352024},
   url={http://dx.doi.org/10.1145/3128572.3140442},
   DOI={10.1145/3128572.3140442},
   journal={Proceedings of the 10th ACM Workshop on Artificial Intelligence and Security - AISec  â€™17},
   publisher={ACM Press},
   author={Raff, Edward and Sylvester, Jared and Nicholas, Charles},
   year={2017}
}

```

